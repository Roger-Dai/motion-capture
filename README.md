# Extracting Data from Motion Capture

The goal of this project is to extract useful pose data from motion capture output to pass to the UR5 robot arm. The motion capture system used in this project is the Xsens Awinda kit. This project is written in MATLAB because of Xsens' compatibility with the program.

## Getting Started

These instructions will get you a copy of the project up and running on your local machine for development and testing purposes. 

### Prerequisites

By the time you move to this project, you should already have the .mvnx output generated by MVN Animate. 

You need to have MATLAB installed on your computer in order to run the programs. You can download the latest MATLAB release here: https://www.mathworks.com/downloads/.

It is *highly recommended* that you simulate the robot arm movements before running the script on a real robot arm since there might be unexpected drastic movements. In order to do so, you could download and install RoboDK on your computer from here: https://robodk.com/download. 

You also need a flashdrive that could transport files from your computer to the UR robot arm controller.

### Installing and Configuring

You simply need to clone this repository to your local directory. No further installation is required if you have all prerequisites installed.

Before you can successfully extract data from the .mvnx file, you have to do the following to set up.

1. Open the program main_mvnx.m, find the line below and change the path so that it points to the .mvnx file you wish to use.

```
tree = load_mvnx("REPLACE THIS WITH THE PATH TO THE .MVNX FILE");
```

2. Oopen the program load_mvnx.m, find the line below and change the path so that it points to where you want the generated .script file to be stored.

```
fileID = fopen('FILEPATH.script','w');
```

3. In the same file, you could edit the translation matrix to adjust for the x y z coordinates so that the robot arm could reach all positions.

Now you are reading to run the program.

## Running the program

Open the program extract_data.m in MATLAB and click the run button. Then in your specified directory, you should see a generated .script file that contains a function, which includes movel() functions that hits all the translated poses. 

### Using the .script file

Open RoboDK, import a robot arm and open the script file. A program is automatically generated and you can run the program in RoboDK to see the resulted movements. If you are unsatisfied with the movements, you could also do some fine-tuning in RoboDK. Afterwards, right click on the program and select "Generate robot program". RoboDK would generate a .urp program and a new .script file for you. Use the flashdrive to transport both files to the robot controller and open the generate .urp program. Run the program on the robot arm controller, and you should see the robot arm carry out the recorded movements from motion capture data.

## Author

* **Roger Dai**

## Acknowledgments

* The program main_mvnx.m and load_mvnx.m are downloaded from Xsens

* Thanks to Professor Daniel Scharstein from Middlebury College for overseeing this project.